{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# ðŸš€ Quick Start: Graphene TLM Simulation\n",
    "\n",
    "[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/YOUR_USERNAME/tlm-graphene-thz/blob/main/notebooks/03_simple_example.ipynb)\n",
    "\n",
    "**Minimal code to simulate graphene R, T, A in the THz range.**\n",
    "\n",
    "This notebook is self-contained - no external files needed!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Install dependencies (Colab only)\n",
    "!pip install -q numpy matplotlib"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# ============================================\n",
    "# PHYSICAL CONSTANTS\n",
    "# ============================================\n",
    "E_CHARGE = 1.602176634e-19      # Electron charge [C]\n",
    "HBAR = 1.054571817e-34          # Reduced Planck constant [JÂ·s]\n",
    "EV_TO_J = 1.602176634e-19       # eV to Joule\n",
    "Z0 = 376.730313668              # Free space impedance [Ohm]\n",
    "\n",
    "# ============================================\n",
    "# GRAPHENE DRUDE CONDUCTIVITY\n",
    "# ============================================\n",
    "def graphene_conductivity(freq, E_F_eV, tau):\n",
    "    \"\"\"\n",
    "    Calculate graphene conductivity using Drude model.\n",
    "    \n",
    "    Parameters:\n",
    "        freq: Frequency in Hz\n",
    "        E_F_eV: Fermi energy in eV\n",
    "        tau: Relaxation time in seconds\n",
    "    \n",
    "    Returns:\n",
    "        Complex conductivity in Siemens\n",
    "    \"\"\"\n",
    "    E_F = E_F_eV * EV_TO_J\n",
    "    omega = 2 * np.pi * freq\n",
    "    gamma = 1.0 / tau\n",
    "    \n",
    "    # Drude model: Ïƒ = (eÂ² E_F)/(Ï€ â„Â²) Ã— i/(Ï‰ + iÎ³)\n",
    "    sigma_0 = (E_CHARGE**2 * E_F) / (np.pi * HBAR**2)\n",
    "    sigma = sigma_0 * 1j / (omega + 1j * gamma)\n",
    "    \n",
    "    return sigma\n",
    "\n",
    "# ============================================\n",
    "# R, T, A CALCULATION\n",
    "# ============================================\n",
    "def calc_RTA(freq, E_F_eV, tau):\n",
    "    \"\"\"\n",
    "    Calculate Reflection, Transmission, Absorption coefficients.\n",
    "    \n",
    "    For a thin conductive sheet:\n",
    "        r = -ÏƒZâ‚€ / (2 + ÏƒZâ‚€)\n",
    "        t = 2 / (2 + ÏƒZâ‚€)\n",
    "    \"\"\"\n",
    "    sigma = graphene_conductivity(freq, E_F_eV, tau)\n",
    "    sigma_norm = sigma * Z0\n",
    "    \n",
    "    # Fresnel coefficients\n",
    "    r = -sigma_norm / (2 + sigma_norm)\n",
    "    t = 2 / (2 + sigma_norm)\n",
    "    \n",
    "    # Power coefficients\n",
    "    R = np.abs(r)**2\n",
    "    T = np.abs(t)**2\n",
    "    A = 1 - R - T\n",
    "    A = np.maximum(A, 0)  # Physical constraint\n",
    "    \n",
    "    return R, T, A\n",
    "\n",
    "print(\"âœ… Functions defined!\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ============================================\n",
    "# ðŸ”§ PARAMETERS - MODIFY HERE!\n",
    "# ============================================\n",
    "\n",
    "E_F = 0.4           # Fermi energy [eV]\n",
    "tau = 100e-15       # Relaxation time [s] (100 fs)\n",
    "\n",
    "# Frequency range: 0.1 - 10 THz\n",
    "freq = np.linspace(0.1e12, 10e12, 500)\n",
    "\n",
    "# ============================================\n",
    "\n",
    "# Calculate R, T, A\n",
    "R, T, A = calc_RTA(freq, E_F, tau)\n",
    "\n",
    "# Find maximum absorption\n",
    "A_max = A.max()\n",
    "f_max = freq[A.argmax()] / 1e12  # in THz\n",
    "\n",
    "print(f\"ðŸ“Š Results:\")\n",
    "print(f\"   Maximum Absorption: {A_max:.1%}\")\n",
    "print(f\"   At frequency: {f_max:.2f} THz\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ============================================\n",
    "# PLOT RESULTS\n",
    "# ============================================\n",
    "\n",
    "fig, axes = plt.subplots(1, 3, figsize=(14, 4))\n",
    "freq_THz = freq / 1e12\n",
    "\n",
    "# Reflection\n",
    "axes[0].plot(freq_THz, R, 'b-', linewidth=2)\n",
    "axes[0].fill_between(freq_THz, 0, R, alpha=0.3)\n",
    "axes[0].set_xlabel('Frequency (THz)')\n",
    "axes[0].set_ylabel('Reflection R')\n",
    "axes[0].set_title('Reflection')\n",
    "axes[0].grid(True, alpha=0.3)\n",
    "axes[0].set_xlim(0, 10)\n",
    "axes[0].set_ylim(0, 0.5)\n",
    "\n",
    "# Transmission\n",
    "axes[1].plot(freq_THz, T, 'g-', linewidth=2)\n",
    "axes[1].fill_between(freq_THz, 0, T, alpha=0.3, color='green')\n",
    "axes[1].set_xlabel('Frequency (THz)')\n",
    "axes[1].set_ylabel('Transmission T')\n",
    "axes[1].set_title('Transmission')\n",
    "axes[1].grid(True, alpha=0.3)\n",
    "axes[1].set_xlim(0, 10)\n",
    "axes[1].set_ylim(0, 1)\n",
    "\n",
    "# Absorption\n",
    "axes[2].plot(freq_THz, A, 'r-', linewidth=2)\n",
    "axes[2].fill_between(freq_THz, 0, A, alpha=0.3, color='red')\n",
    "axes[2].axhline(A_max, color='darkred', linestyle='--', alpha=0.5)\n",
    "axes[2].plot(f_max, A_max, 'ro', markersize=10)\n",
    "axes[2].annotate(f'{A_max:.1%} @ {f_max:.1f} THz', \n",
    "                 xy=(f_max, A_max), xytext=(f_max+1, A_max+0.05),\n",
    "                 fontsize=10, arrowprops=dict(arrowstyle='->'))\n",
    "axes[2].set_xlabel('Frequency (THz)')\n",
    "axes[2].set_ylabel('Absorption A')\n",
    "axes[2].set_title('Absorption')\n",
    "axes[2].grid(True, alpha=0.3)\n",
    "axes[2].set_xlim(0, 10)\n",
    "axes[2].set_ylim(0, 0.5)\n",
    "\n",
    "fig.suptitle(f'Graphene R, T, A â€” E_F = {E_F} eV, Ï„ = {tau*1e15:.0f} fs', fontsize=14)\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ============================================\n",
    "# SINGLE PLOT (ALL COEFFICIENTS)\n",
    "# ============================================\n",
    "\n",
    "plt.figure(figsize=(10, 6))\n",
    "plt.plot(freq_THz, R, 'b-', linewidth=2, label='Reflection R')\n",
    "plt.plot(freq_THz, T, 'g-', linewidth=2, label='Transmission T')\n",
    "plt.plot(freq_THz, A, 'r-', linewidth=2, label='Absorption A')\n",
    "plt.plot(freq_THz, R + T + A, 'k--', linewidth=1, alpha=0.5, label='R+T+A (=1)')\n",
    "\n",
    "plt.xlabel('Frequency (THz)', fontsize=12)\n",
    "plt.ylabel('Coefficient', fontsize=12)\n",
    "plt.title(f'Graphene Optical Coefficients\\nE_F = {E_F} eV, Ï„ = {tau*1e15:.0f} fs', fontsize=14)\n",
    "plt.legend(loc='best', fontsize=11)\n",
    "plt.grid(True, alpha=0.3)\n",
    "plt.xlim(0, 10)\n",
    "plt.ylim(0, 1.05)\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ============================================\n",
    "# COMPARE DIFFERENT PARAMETERS\n",
    "# ============================================\n",
    "\n",
    "fig, axes = plt.subplots(1, 2, figsize=(14, 5))\n",
    "\n",
    "# Vary Fermi energy\n",
    "for E_F_val in [0.2, 0.4, 0.6, 0.8]:\n",
    "    _, _, A = calc_RTA(freq, E_F_val, tau)\n",
    "    axes[0].plot(freq_THz, A, linewidth=2, label=f'E_F = {E_F_val} eV')\n",
    "\n",
    "axes[0].set_xlabel('Frequency (THz)')\n",
    "axes[0].set_ylabel('Absorption A')\n",
    "axes[0].set_title(f'Effect of Fermi Energy (Ï„ = {tau*1e15:.0f} fs)')\n",
    "axes[0].legend()\n",
    "axes[0].grid(True, alpha=0.3)\n",
    "axes[0].set_xlim(0, 10)\n",
    "axes[0].set_ylim(0, 0.5)\n",
    "\n",
    "# Vary relaxation time\n",
    "for tau_val in [20e-15, 50e-15, 100e-15, 200e-15, 500e-15]:\n",
    "    _, _, A = calc_RTA(freq, E_F, tau_val)\n",
    "    axes[1].plot(freq_THz, A, linewidth=2, label=f'Ï„ = {tau_val*1e15:.0f} fs')\n",
    "\n",
    "axes[1].set_xlabel('Frequency (THz)')\n",
    "axes[1].set_ylabel('Absorption A')\n",
    "axes[1].set_title(f'Effect of Relaxation Time (E_F = {E_F} eV)')\n",
    "axes[1].legend()\n",
    "axes[1].grid(True, alpha=0.3)\n",
    "axes[1].set_xlim(0, 10)\n",
    "axes[1].set_ylim(0, 0.5)\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## ðŸ“š Key Insights\n",
    "\n",
    "1. **Higher Fermi energy** â†’ More free carriers â†’ Higher absorption\n",
    "2. **Longer relaxation time** â†’ Sharper spectral features\n",
    "3. **Maximum absorption** for monolayer graphene is theoretically ~50% (half of incident power)\n",
    "\n",
    "### Physical Limits\n",
    "- For a symmetric structure (air-graphene-air), maximum absorption is **50%**\n",
    "- To exceed this, use asymmetric structures or multiple layers\n",
    "\n",
    "### Drude Model Validity\n",
    "- Valid for **intraband transitions** (low frequency)\n",
    "- For **interband transitions** (visible/UV), use Kubo formula"
   ]
  }
 ],
 "metadata": {
  "colab": {
   "provenance": []
  },
  "kernelspec": {
   "display_name": "Python 3",
   "name": "python3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 0
}
